<div class="fullscreen-overlay" :class="{ 'open': isFullscreen }">
    <div class="absolute inset-0 -z-10">
        <img v-if="playingTrack" :src="playingTrack.image" class="w-full h-full object-cover opacity-40 blur-[80px] scale-125">
        <div class="absolute inset-0 bg-black/60"></div>
    </div>

    <div class="flex flex-col h-full px-8 pt-16 pb-12 text-white">
        <button @click="isFullscreen = false" class="self-start w-10 h-10 flex items-center justify-center bg-white/10 rounded-full mb-8">
            <i class="fas fa-chevron-down"></i>
        </button>

        <div class="flex-1 flex flex-col items-center justify-center">
            <img v-if="playingTrack" :src="playingTrack.image" class="w-72 h-72 md:w-96 md:h-96 rounded-[2.5rem] shadow-2xl mb-12 border border-white/10">
            
            <div class="w-full max-w-md text-center">
                <h2 class="text-xl font-bold mb-2 line-clamp-2">{{ playingTrack?.title }}</h2>
                <p class="text-indigo-400 font-bold text-xs uppercase tracking-widest">{{ playingTrack?.channelName }}</p>
            </div>
        </div>

        <div class="w-full max-w-md mx-auto space-y-8">
            <div class="space-y-2">
                <input type="range" :max="duration" :value="currentTime" @input="seek" class="w-full accent-white">
                <div class="flex justify-between text-[10px] font-mono opacity-40">
                    <span>{{ formatTime(currentTime) }}</span>
                    <span>{{ formatTime(duration) }}</span>
                </div>
            </div>

            <div class="flex items-center justify-between px-4">
                <button @click="changeSpeed" class="w-10 text-[10px] font-bold border border-white/20 rounded-md py-1">{{ playbackRate }}x</button>
                <div class="flex items-center gap-10">
                    <button @click="skip(-15)" class="text-2xl opacity-60"><i class="fas fa-undo"></i></button>
                    <button @click="togglePlay" class="w-20 h-20 bg-white text-black rounded-full flex items-center justify-center shadow-xl active:scale-90 transition">
                        <i :class="['fas', isPlaying ? 'fa-pause' : 'fa-play', 'text-2xl']" :class="{'ml-1': !isPlaying}"></i>
                    </button>
                    <button @click="skip(30)" class="text-2xl opacity-60"><i class="fas fa-redo"></i></button>
                </div>
                <div class="w-10"></div> </div>
        </div>
    </div>
</div>

<script>
// 在你的 parseRSS 函数中替换以下部分
const parseRSS = async (file) => {
    // ... 前面的逻辑
    const channel = dom.querySelector("channel");
    
    // 【简介修复】：多级查找
    const description = 
        dom.getElementsByTagNameNS("http://www.itunes.com/dtds/podcast-1.0.dtd", "summary")[0]?.textContent ||
        dom.getElementsByTagNameNS("http://www.itunes.com/dtds/podcast-1.0.dtd", "subtitle")[0]?.textContent ||
        channel.querySelector("description")?.textContent ||
        "暂无简介";

    // ... 剩下的逻辑
    return { title, author, image, description, episodes };
};

// 在 setup() 中添加播放逻辑
const togglePlay = () => {
    if (!player.value) return;
    isPlaying.value ? player.value.pause() : player.value.play();
};

const playTrack = (ep) => {
    playingTrack.value = { ...ep, channelName: currentPodcast.value.title };
    nextTick(() => {
        player.value.load();
        player.value.play();
    });
};
</script>
